
int append_file  (char*file, char *buffer, short size) { 
  assert (size%128==0);
  int nb_blocs = size/128;
  int i;
  struct ent_dir * pt = pt_DIR;
  short bloc_ajout;
  short* pt_fat = pt_FAT;
  char* txt = buffer;

  for(i = 0; i< NB_DIR; i++){
    if( (pt->del_flag) && (!strcmp(pt->name, file))){
      /*On a trouvé le fichier*/
      /*On écrit dans chaque bloc ce qu'il faut depuis le buffer*/
      pt->size += size;
      for (int j = 0; j < nb_blocs; j++){
        bloc_ajout = alloc_bloc();      //Nouveau dernier bloc
        if(bloc_ajout == -1){
          return -1;    //Plus de place dans la FAT
        }
        if(pt->size == 0){            //On a aucun bloc pour ce fichier
          pt->first_bloc = bloc_ajout;
        }
        else{
          pt_fat[pt->last_bloc] = bloc_ajout;     //On maintient le chaînage
        }
        pt->last_bloc = bloc_ajout;             //Le bloc ajouté est le nouveau dernier !
        

        /*On écrit sur notre bloc*/
        
        if (write_sector(bloc_ajout,txt) == -1){
          return -1;
        }
        txt = txt + 128;
      }

      if(write_DIR_FAT_sectors()== -1){
        return -1;
      }
      return 0;
    }
    pt++;
  } 
  /*On n'a pas trouvé le fichier où écrire*/
  return -1;

}
